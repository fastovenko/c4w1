<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DataFrame.groupby</title>
    <style type="text/css">
        body {
            font-family: verdana, arial, sans-serif;
        }
        b {
            font-size: 125%;
            color: blue;
        }
    </style>
</head>
<body>
<div><p>
    В этом видео мы поговорим про то, как можно группировать данные в pandas, и какие можно делать манипуляции с
    получившими группами. Допустим у нас есть некоторая переменная, она принимает 2 или может быть несколько значений, и
    мы хотим выделить все стройки, которых встречается только первое значение, только второе и так далее. Это можно
    осуществить с помощью метода groupby, затем, после того как у нас выделилась некоторая группа, мы можем уже с ней
    отдельно работать, смотреть распределение других признаков по данной группе, а также можно сравнивать эти группы
    между собой. Давайте посмотрим, как это можно сделать в pandas. Для этого нам необходимо вызвать метод
    <b>groupby</b> и передать тот столбец, по которому мы хотим сгруппировать наши строки. Например, это тип
    пользователей. Мы видим, что возвращается некоторый объект датафрейма groupby, и чтобы посмотреть, какие у нас
    получились группы, можно воспользоваться атрибутом <b>groups</b>, в результате которого у нас вернется некоторый
    словарь, где в качестве ключа лежат значения с группируемой переменной, в данном случае их всего два, а в качестве
    значения лежат индексы строк, в которых встречается именно это значение. Это такое представление групп. А затем мы
    можем помимо такого представления в виде индексов уже посмотреть какие конкретно значения и строки у нас встречаются
    в группе. Для этого можно, например, посмотреть первые строки из каждой группы. Также мы сначала осуществляем
    группировку, а затем можно вызвав метод <b>first</b>, посмотреть что из себя представляет каждая строка из первой
    группы. То есть здесь уже возвращается некоторый датафрейм со всеми признаками, которые были изначально. И теперь,
    когда у нас уже есть некоторая сгруппированная структура, мы можем посчитать некоторое распределение значений.
    Допустим, мы хотим посмотреть среднюю продолжительность поездок по каждой группе пользователей. Как это можно
    сделать? Мы также осуществляем группировку данных, а затем, после groupby мы указываем лист значений необходимых
    для агрегирования, и затем метод, который мы хотим, по которому мы собственно говоря агрегируем данные, например,
    средняя продолжительность поездок. У нас возвращается некоторый датафрейм, а также, если мы укажем в качестве
    аргумента не лист значений, а всего лишь одно значение, в данном случае продолжительность поездки, у нас уже
    вернется объект типа serious. Также позволяет группировать данные не только по какому-то одному признаку, а сразу же
    по группе признаков. Для этого нам просто необходимо добавить еще дополнительный столбец в метод <b>groupby</b>.
    В данном случае у нас вернулась такая расширенная serious, давайте посмотрим как это будет выглядеть в датафрейме, и
    у нас уже возвращается индекс из наших двух значений и соответствующая ей агрегированная величина. После группировки
    данных pandas можно уже считать некоторое агрегированное значение по признакам для каждой группы, но если нас
    интересует какое-либо распределение значения не только по одному признаку, а сразу же по нескольким признакам, то
    это можно сделать, используя метод aggregate, то есть сначала мы также группируем наши данные, затем мы вызываем
    метод <b>aggregate</b>, где в качестве аргумента мы можем передать словарь следующего вида: мы передаем в качестве
    ключей нужные признаки для агрегации, и мы можем передать, например, сразу же несколько признаков. В результате
    применения метода aggregate возвращается датафрейм, где индекс - это наш исходный признак группировки и
    соответствующие два столбца с нужными значениями. Также, если нам необходимо посмотреть изменение значений или
    вообще какие-либо другие метрики по какому-то одному признаку, мы можем в этом же словаре, для этого признака, в
    качестве значения указывать лист методов, и в результате получившийся датафрейм мы видим, что по признаку, в котором
    указано сразу несколько методов, возвращаются уже другие значения. Давайте еще рассмотрим тот вариант, когда мы
    хотим посчитать какой-нибудь значение, не используя встроенные функции, а используя какие-то свои функции. Это можно
    сделать, например, используя лямбда функцию, и соответственно, значение будет меняться. В этом видео мы поговорили
    про то, как можно группировать данные в pandas, что это можно делать сразу же по нескольким переменным, и каким
    удобным способом можно агрегировать значение по данным. В следующем видео мы подробно поговорим про то, как можно
    работать с несколькими таблицами одновременно, строить разные связи между ними.
</p></div>
</body>
</html>