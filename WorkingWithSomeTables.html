<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Working With Some Tables</title>
    <style type="text/css">
        body {
            font-family: verdana, arial, sans-serif;
        }
        b {
            font-size: 125%;
            color: blue;
        }
    </style>
</head>
<body>
<div><p>
    В этом видео мы поговорим про то, как работать с несколькими таблицами в Python и как их можно связывать друг с
    другом по каким-либо атрибутам или полям. Для начала давайте рассмотрим следующую ситуацию. Представьте, что есть
    некоторый датасет, который состоит не из одной таблицы, а сразу из нескольких. Например, это датасет квартир Airbnb,
    он состоит из нескольких таблиц. Одна таблица относится к характеристикам самих квартир, другая таблица содержит
    календарь бронирования, а третья таблица отвечает за отзывы, которые оставляют посетители этих квартир. И нам
    необходимо каким-то образом связать эти три сущности вместе. То есть, если мы хотим посмотреть связь между тем,
    какой тип квартиры, с тем, какие отзывы оставляли люди, нам нужно как-то совместить эти два датасета. Самый простой
    способ, которым это можно сделать, — это сделать <b>join</b>. Вообще, какие бывают виды join'ов? Представим, что у
    нас есть две таблицы. И у них есть какое-то общее поле, например, ID квартиры. Как мы можем совместить эти два
    датасета? Допустим, мы можем взять все строки из правой части и добавить их все к левой части. Можем сделать
    наоборот: все строки из левой части добавить к правой, либо сделать какое-то пересечение двух таблиц, либо же взять
    какое-то их общее объединение. В Pandas существует два метода join'а таблиц. Один называется merge, другой — join.
    Они отличаются тем, что с помощью метода <b>merge</b> мы можем связывать две таблицы по каким-то признакам, а в
    случае join мы связываем две таблицы по какому-то общему индексу. Давайте рассмотрим конкретные примеры. Вернёмся к
    нашим таблицам. Таблица listing содержит подробную информацию о самих квартирах. Reviews — это некоторые отзывы,
    которые оставляли люди. И calendar — когда было совершено бронирование квартиры. Давайте попробуем к таблице
    <b>listings</b> добавить отзывы людей, используя метод merge. Синтаксис выглядит следующим образом: нам необходимо
    указать левую таблицу и, собственно говоря, правую. Выбираем сначала таблицу listings и затем добавляем таблицу,
    которую мы хотим привязать. Далее, нам надо выбрать столбцы из каждой таблицы, по которой у нас происходит
    присоединение. В идеале у нас могут названия столбцов совпадать, что в одной, что в другой таблице. Но бывают
    ситуации, что названия столбцов не совпадают, и для этого мы можем, используя аргумент left_on и right_on, указать
    нужные названия столбцов. Заметим, что в таблице listings ID квартиры назывется ID, а в reviews она называется
    немножко по-другому. Поэтому мы указываем нужные названия столбцов в методе merge. И результатом является некоторая
    таблица, она уже довольно большая, и как вы видите, у нас добавились некоторые значения из таблицы reviews. По
    умолчанию метод merge, если не указывать, какой метод join мы хотим осуществить, осуществляет left join, то есть
    добавляет все значения из правой таблицы к левой. Также мы можем это поменять, просто указав в аргументе нужный
    метод. Также, если мы хотим понять, из какой таблицы куда добавились значения pd.merge, можно поменять значение у
    параметра <b>indicator</b>, которое покажет, из каких таблиц были взяты выбранные значения. То есть в датафрейме
    возвращается дополнительный столбец merge. И в качестве аргумента уже указывается тип join'а, точнее то, откуда было
    взято значение. Давайте рассмотрим пример join'а, как осуществляется join при применении другого метода. Для этого
    нам необходимо у каждой из таблиц, которые мы хотим совместить, задать некоторый индекс. В данном случае возьмём
    индекс listing_ID. И сделаем то же самое для другой таблицы. Теперь нам нужно выбрать левую таблицу, допустим, это
    будет calendar. И применив метод <b>join</b>, мы передаём таблицу, которую хотим присоединить. И также необходимо
    указать индекс левой и правой таблиц. Мы видим, что у нас добавились значения к calendar из отзывов, и теперь у нас
    задан новый индекс, и, как мы видим, значений в нашей таблице стало сильно больше. В этом видео мы разобрались,
    как совмещать два датафрейма друг с другом и как комбинировать данные из разных таблиц. В следующем видео мы
    поговорим про то, как делать различные преобразования со столбцами и строками в Pandas.
</p></div>
</body>
</html>